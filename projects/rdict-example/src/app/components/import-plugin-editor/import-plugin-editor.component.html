<div class="steppyContainer">
  <button [size]="'large'" class="prevStep" kendoButton (click)="prevStep()"
  [disabled]="currentStep === 0">Back</button>
  <kendo-stepper [(currentStep)]="currentStep" [steps]="steps"></kendo-stepper>
  <button [size]="'large'" class="nextStep" kendoButton (click)="nextStep()" [disabled]="isNextDisabled"
  themeColor="primary">{{nextText()}}</button>
</div>

<!--
//Unu simplu in care data si ora sunt impreuna, pe verticala, si sunt 4 coloane cu valori
{
"tz": "Europe/Bucharest",
"timestamp": { "start": "C3", "direction": "down", "format": "%d.%m.%Y %H:%M:%S" },
"field_names": { "start": "D2", "end": "G2"},
}
//Data este una singura, orele sunt pe orizontala.
{
"tz": "Europe/Bucharest",
"time": { "start": "B4", "direction": "right", "format": "%H:%M:%S" },
"date": { "start": "A2", "direction": "single", "format": "%d.%m.%Y" },
"field_names": { "start": "A5", "end": "A6" },
}
//Date pe randuri, ore pe coloana
{
"tz": "Europe/Bucharest",
"time": { "start": "B3", "direction": "right", "format": "%H:%M:%S" },
"date": { "start": "A4", "direction": "down", "format": "%d.%m.%Y" },
"field_names": { "fixed": "Productie (MWh)" },
}
-->

@if (currentStep === 0) {
  <section class="step one">
    <h4>Incarcati un fisier Excel. Dupa incarcare selectati foaia dorita. Daca foaia dorita este deja selectata puteti
    merge la pasul urmator. </h4>
    <input (change)="onFileSelected($event)" type="file">
    <br>
      <h5 [ngStyle]="{opacity: spreadsheetVisibility}">
        Foaia activa este: {{spreadsheetRef.activeSheet}}
      </h5>
    </section>
  }
  @if (currentStep === 1) {
    <section class="step two">
      <h4>Corectati maparea campurilor din fisierul cu campurile din aplicatie.</h4>
      @if (!hasItBeenAnalyzed) {
        <kendo-loader type="infinite-spinner" size="large"></kendo-loader>
      }
      @if (hasItBeenAnalyzed) {
        <div class="edit data">
          @if (ai_response.tz) {
            <div class="filter">
              <h4>Fus orar</h4>
              <div class="group">
                <label for="tz">Fus orar</label>
                <select (change)="rangeModif()" class="full" name="tmezone" id="tz">
                  <option value="Europe/Bucharest">Europe/Bucharest</option>
                </select>
              </div>
            </div>
          }
          @if (ai_response.timestamp) {
            <div class="filter">
              <h4>Marcaj temporal</h4>
              <div class="group">
                <label for="timestamp_start">start</label>
                <input (input)="rangeModif()" [(ngModel)]="ai_response.timestamp.start" class="half" type="text">
              </div>
              <div class="group">
                <label for="timestamp_direction">Directie</label>
                <select (change)="rangeModif()" class="full" name="timestamp_direction" id="timestamp_direction">
                  <option value="jos">jos</option>
                  <option value="sus">dreapta</option>
                </select>
              </div>
              @if (ai_response.timestamp.format) {
                <div class="group">
                  <label for="Timestamp_format">format</label>
                  <input (input)="rangeModif()" type="text" class="full" id="Timestamp_format"
                    [(ngModel)]="ai_response.timestamp.format">
                  </div>
                }
              </div>
            }
            @if (ai_response.time) {
              <div class="filter">
                <h4>Ora</h4>
                @if (ai_response.time.start) {
                  <div class="group">
                    <label for="time_start">start</label>
                    <input (input)="rangeModif()" [(ngModel)]="ai_response.time.start" class="half" type="text">
                  </div>
                }
                @if (ai_response.time.direction) {
                  <div class="group">
                    <label for="time_direction">Directie</label>
                    <select (change)="rangeModif()" class="full" name="time_direction" id="time_direction">
                      <option value="jos">jos</option>
                      <option value="dreapta">dreapta</option>
                    </select>
                  </div>
                }
                @if (ai_response.time.format) {
                  <div class="group">
                    <label for="Timestamp_format">format</label>
                    <input (input)="rangeModif()" type="text" class="full" id="Timestamp_format"
                      [(ngModel)]="ai_response.time.format">
                    </div>
                  }
                </div>
              }
              @if (ai_response.date) {
                <div class="filter">
                  <h4>Data</h4>
                  <div class="group">
                    <label for="timestamp_start">start</label>
                    <input (input)="rangeModif()" [(ngModel)]="ai_response.date.start" class="half" type="text">
                  </div>
                  @if (ai_response.date.direction) {
                    <div class="group">
                      <label for="timestamp_direction">Directie</label>
                      <select (change)="rangeModif()" class="full" name="timestamp_direction" id="timestamp_direction">
                        <option value="jos">jos</option>
                        <option value="sus">dreapta</option>
                      </select>
                    </div>
                  }
                  @if (ai_response.date.format) {
                    <div class="group">
                      <label for="Timestamp_format">format</label>
                      <input (input)="rangeModif()" type="text" class="full" id="Timestamp_format"
                        [(ngModel)]="ai_response.date.format">
                      </div>
                    }
                  </div>
                }
                @if (ai_response.field_names) {
                  <div class="filter">
                    <h4>Nume campuri</h4>
                    @if (ai_response.field_names.start) {
                      <div class="group">
                        <label for="field_names_start">start</label>
                        <input (input)="rangeModif()" [(ngModel)]="ai_response.field_names.start" class="half" type="text">
                      </div>
                    }
                    @if (ai_response.field_names.end) {
                      <div class="group">
                        <label class="field_names_start">sfarsit</label>
                        <input (input)="rangeModif()" [(ngModel)]="ai_response.field_names.end" class="half" type="text">
                      </div>
                    }
                    <!-- <div class="group">
                    <label for="field_names_direction">directie</label>
                    <select (change)="rangeModif()" class="full" name="field_names_direction" id="value_shape">
                      <option value="infer">infer</option>
                    </select>
                  </div> -->
                </div>
              }
            </div>
          }
        </section>
      }

      @if (currentStep === 2) {
        <section class="step three">
          {{typesOfData | json}}
          @for (dt of typesOfData; track dt) {
            {{dt}}
          }
          <h4>Salvați setarile de import.</h4>
          <button>Salvați</button>
        </section>
      }

      <kendo-spreadsheet #spreadsheetRef [ngStyle]="{opacity: spreadsheetVisibility}"
      (activeSheetChange)="sheetChange($event)" (change)="onChange($event, 'change')"> </kendo-spreadsheet>